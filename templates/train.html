{% extends "layout.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">Train Model</div>
            <div class="card-body text-center">
                <p>Click the button below to train the face recognition model with the collected dataset.</p>

                <button id="trainBtn" class="btn btn-warning btn-lg">Train Model</button>

                <div id="loading" class="mt-3" style="display:none;">
                    <div class="spinner-border text-warning" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p>Training in progress... This may take a few seconds.</p>
                </div>

                <div id="result" class="mt-3 alert alert-info" style="display:none;"></div>
            </div>
        </div>
    </div>
</div>

<script>
    document.getElementById('trainBtn').addEventListener('click', async () => {
        const btn = document.getElementById('trainBtn');
        const loading = document.getElementById('loading');
        const resultDiv = document.getElementById('result');

        btn.disabled = true;
        loading.style.display = 'block';
        resultDiv.style.display = 'none';

        try {
            const response = await fetch('/api/train', { method: 'POST' });
            const data = await response.json();

            resultDiv.innerText = data.message;
            resultDiv.style.display = 'block';
        } catch (err) {
            resultDiv.innerText = "Error during training: " + err;
            resultDiv.style.display = 'block';
        } finally {
            btn.disabled = false;
            loading.style.display = 'none';
        }
    });
</script>
{% endblock %}